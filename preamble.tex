\documentclass[11pt,twoside,a4paper,openright]{book}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Language, Encoding and Fonts
% http://en.wikibooks.org/wiki/LaTeX/Internationalization
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Select encoding of your inputs. Depends on
% your operating system and its default input
% encoding. Typically, you should use
%   Linux  : utf8 (most modern Linux distributions)
%            latin1 
%   Windows: ansinew
%            latin1 (works in most cases)
%   Mac    : applemac
% Notice that you can manually change the input
% encoding of your files by selecting "save as"
% an select the desired input encoding.
% WARNING: If you decide to change the input encoding to something else than
% UTF-8, you have to change the encoding of ALL files and update the Python
% scripts which is set up to read and write UTF-8 files.
\usepackage[utf8]{inputenc}
% Make latex understand and use the typographic
% rules of the language used in the document.
\usepackage[english]{babel}
% Use the palatine font
\usepackage[sc]{mathpazo}
\linespread{1.05}         % Palatino needs more leading (space between lines)
% Choose the font encoding
\usepackage[T1]{fontenc}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Graphics and Tables
% http://en.wikibooks.org/wiki/LaTeX/Importing_Graphics
% http://en.wikibooks.org/wiki/LaTeX/Tables
% http://en.wikibooks.org/wiki/LaTeX/Colors
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% load a colour package
\usepackage[usenames,dvipsnames]{xcolor}
%\definecolor{aaublue}{rgb}{0.00,0.41,0.66}% dark blue
\definecolor{aaublue}{RGB}{33,26,82}% dark blue
\definecolor{aaugray}{RGB}{84,97,110}% gray blue
\definecolor{aaulblue}{RGB}{194,193,204} % light blue
% The standard graphics inclusion package
\usepackage{graphicx}
\DeclareGraphicsExtensions{% set the priority
    .pdf,.PDF,%
    .png,.PNG,%
    .jpg,.mps,.jpeg,.jbig2,.jb2,.JPG,.JPEG,.JBIG2,.JB2}
% Create graphics using PGF/TikZ
\usepackage{tikz,pgfplots}
\usetikzlibrary{plotmarks}
% \usetikzlibrary{matrix,backgrounds}
% usetikzlibrary{external}
% \tikzexternalize[
  % mode=convert with system call,% or graphics if exists, no graphics, only graphics
  % figure list=true]
% \tikzexternaldisable
% \tikzexternalize[prefix=img/tikz/]
\tikzset{
    >=latex,
    font=\footnotesize,
}
\pgfplotsset{
    compat=newest,
    every axis plot/.append style = {
        very thick,
    },
    every axis legend/.append style={
        font={\scriptsize},
    },
    every axis title/.append style={
        font={\small},
    },
    every axis/.append style={
        legend style={draw=none},
        legend cell align=left,
        axis x line=bottom,
        axis y line=left,
        scaled ticks=false,
        width=11cm,
        height=5cm,
        axis line style=-latex,
        tick scale binop=\times,
        /pgf/number format/.cd,
        set thousands separator={},
        set decimal separator={,},
    },
    every axis x label/.style={
        at={(ticklabel* cs:1.00)},
        anchor=west,
        font={\small},
    },
    every axis y label/.style={
        at={(ticklabel* cs:1.00)},
        anchor=south,
        font={\small},
    },
}

% Set up how figure and table captions are displayed
\usepackage{caption}
\captionsetup{%
  font=footnotesize,% set font size to footnotesize
  labelfont=bf % bold label (e.g., Figure 3.2) font
}
% Make the standard latex tables look so much better
\usepackage{array,booktabs}
% Enable the use of frames around, e.g., theorems
% The framed package is used in the example environment
\usepackage{framed}
%adobe reader fix when using transparency in tikz
\pdfpageattr{/Group <</S /Transparency /I true /CS /DeviceRGB>>}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Mathematics
% http://en.wikibooks.org/wiki/LaTeX/Mathematics
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Defines new environments such as equation,
% align and split 
\usepackage{amsmath}
% Adds new math symbols
\usepackage{amssymb}
% Use theorems in your document
% The ntheorem package is also used for the example environment
% When using thmmarks, amsmath must be an option as well. Otherwise \eqref doesn't work anymore.
\usepackage[framed,amsmath,thmmarks]{ntheorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Page Layout
% http://en.wikibooks.org/wiki/LaTeX/Page_Layout
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Change margins, papersize, etc of the document
\usepackage[
  inner=18mm,% left margin on an odd page
  outer=45mm,% right margin on an odd page
  marginparwidth=35mm, % width of the marginal paragraph
  headheight=14pt,
  ]{geometry}
% Modify how \chapter, \section, etc. look
% The titlesec package is very configureable
\usepackage{titlesec}
\titleformat*{\section}{\normalfont\Large\bfseries\color{aaublue}}
\titleformat*{\subsection}{\normalfont\large\bfseries\color{aaublue}}
%\titleformat*{\subsubsection}{\normalfont\normalsize\bfseries\color{aaublue}}
%\titleformat*{\paragraph}{\normalfont\normalsize\bfseries\color{aaublue}}
%\titleformat*{\subparagraph}{\normalfont\normalsize\bfseries\color{aaublue}}

% Change the headers and footers
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{} %delete everything
\renewcommand{\headrulewidth}{0pt} %remove the horizontal line in the header
\fancyhead[RE]{\color{aaublue}\small\nouppercase\leftmark} %even page - chapter title
\fancyhead[LO]{\color{aaublue}\small\nouppercase\rightmark} %uneven page - section title
\fancyhead[LE,RO]{\thepage} %page number on all pages
% Do not stretch the content of a page. Instead,
% insert white space at the bottom of the page
\raggedbottom
% Enable arithmetics with length. Useful when
% typesetting the layout.
\usepackage{calc}
% fix the marginpar command so it is always on the correct side
\usepackage{mparhack}
% truncate a long file name
\usepackage[breakall]{truncate}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Algorithms and pseudocode
% http://en.wikibooks.org/wiki/LaTeX/Algorithms
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% package for writing algorithms and pseudocode
\usepackage{algpseudocode}
% change the appearance of comments
\algrenewcommand{\algorithmiccomment}[2][\hfill]{#1{\color{aaugray}\# #2}}
% float environment for algorithms
\usepackage{algorithm}
% display source code
\usepackage{listings}
\usepackage[numbered, framed, autolinebreaks, useliterate]{mcode}
% \lstset{breaklines=true,
%   tabsize=2,
%   numbers=left,
%   basicstyle=\scriptsize\ttfamily,
%   commentstyle=\color{OliveGreen},
%   keywordstyle=\color{blue}\bf,
%   stringstyle=\color{red},
%   breaklines=true,
%   inputencoding=utf8,
%   extendedchars=true}
% \lstset{literate=%
% {æ}{{\ae}}1
% {å}{{\aa}}1
% {ø}{{\o}}1
% {Æ}{{\AE}}1
% {Å}{{\AA}}1
% {Ø}{{\O}}1
% }
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Bibliography
% http://en.wikibooks.org/wiki/LaTeX/Bibliography_Management
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\bibliographystyle{IEEEtranS}
\usepackage[backend=bibtex,
  bibencoding=utf8
  ]{biblatex}
\addbibresource{IEEEabrv.bib}
\addbibresource{bib/mybib.bib}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Misc
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Add an index
\usepackage[makeindex]{splitidx}
\newindex[People Index]{person}
\newindex[File Index]{file}
\newindex[Author Index]{author}
\newindex[Tag Index]{tag}
% Add bibliography and index to the table of
% contents
\usepackage[nottoc]{tocbibind}
% Add the command \pageref{LastPage} which refers to the
% page number of the last page
\usepackage[
%  disable, %turn off todonotes
  colorinlistoftodos, %enable a coloured square in the list of todos
  textwidth=\marginparwidth, %set the width of the todonotes
  textsize=scriptsize, %size of the text in the todonotes
]{todonotes}
% \makeatletter
% \renewcommand{\todo}[2][]{\tikzexternaldisable\@todo[#1]{#2}\tikzexternalenable}
% \makeatother
% \makeatletter
% \renewcommand{\missingfigure}[2][]{\tikzexternaldisable\@missingfigure[#1]{#2}\tikzexternalenable}
% \makeatother

\usepackage{lipsum}                     % Dummytext
\usepackage{xargs}                      % Use more than one optional parameter in a new commands
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Hyperlinks
% http://en.wikibooks.org/wiki/LaTeX/Hyperlinks
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Enable hyperlinks and insert info into the pdf
% file. Hypperref should be loaded as one of the 
% last packages
\usepackage{hyperref}
\hypersetup{%
	pdfpagelabels=true,%
	plainpages=false,%
	pdfauthor={},%
	pdftitle={},%
	pdfsubject={},%
	bookmarksnumbered=true,%
	colorlinks,%
	citecolor=aaublue,%
	filecolor=aaublue,%
	linkcolor=aaublue,% you should probably change this to black before printing
	urlcolor=aaublue,%
	pdfstartview=FitH%
}
